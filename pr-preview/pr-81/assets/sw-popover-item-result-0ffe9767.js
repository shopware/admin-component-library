import{d as Z,e as k,M as G,o as g,p,f as A,l as v,F as S,z as M,s as L,w as O,k as H,t as X,N as J,O as K,B as $}from"./vue.esm-bundler-f31f98e0.js";import{S as Q}from"./sw-search-e6edbf88.js";import{S as U,c as W}from"./sw-popover-4459090d.js";import{i as f}from"./isFunction-97e00978.js";import{i as N}from"./isObject-32699ff3.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";let o=null,s=null,i=null,y=0,w=0,h=null;const b=[],F={delay:100,dragGroup:1,draggableCls:"is--draggable",draggingStateCls:"is--dragging",dragElementCls:"is--drag-element",validDragCls:"is--valid-drag",invalidDragCls:"is--invalid-drag",preventEvent:!0,validateDrop:null,validateDrag:null,validateDragStart:null,onDragStart:null,onDragEnter:null,onDragLeave:null,onDrop:null,data:null,disabled:!1},Y={dragGroup:1,droppableCls:"is--droppable",validDropCls:"is--valid-drop",invalidDropCls:"is--invalid-drop",validateDrop:null,onDrop:null,data:null};function ee(e,t,a){return a instanceof MouseEvent&&a.buttons!==1?!1:(t.preventEvent&&(a.preventDefault(),a.stopPropagation()),t.delay===null||t.delay<=0?x(e,t,a):h=window.setTimeout(x.bind({},e,t,a),t.delay),document.addEventListener("mouseup",D),document.addEventListener("touchend",D),!0)}function x(e,t,a){if(t.validateDragStart!==null&&!t.validateDragStart(t.data,e,a)||(h=null,o!==null))return;o={el:e,dragConfig:t};const n=e.getBoundingClientRect(),l=a instanceof MouseEvent&&a.pageX||a instanceof TouchEvent&&a.touches[0].pageX,m=a instanceof MouseEvent&&a.pageY||a instanceof TouchEvent&&a.touches[0].pageY;y=l-n.left,w=m-n.top,i=e.cloneNode(!0),i.classList.add(t.dragElementCls),i.style.width=`${n.width}px`,i.style.translate=`${l-y}px ${m-w}px`,i.style.left="0",i.style.top="0",document.body.appendChild(i),e.classList.add(t.draggingStateCls),f(o.dragConfig.onDragStart)&&o.dragConfig.onDragStart(o.dragConfig,e,i),document.addEventListener("mousemove",_),document.addEventListener("touchmove",_)}let R=0;function ae(e,t){return e&&Math.abs(t-e)>2?`${t-e>0?5:-5}deg`:""}function _(e){if(o===null){D();return}const t=e instanceof MouseEvent&&e.pageX||e instanceof TouchEvent&&e.touches[0].pageX,a=e instanceof MouseEvent&&e.pageY||e instanceof TouchEvent&&e.touches[0].pageY;if(i){const n=Number(i.dataset.translateX),l=t-y,m=a-w;i.style.rotate=ae(n,l),clearTimeout(R),R=window.setTimeout(()=>{i&&(i.style.rotate="0deg")},100),i.style.translate=`${l}px ${m}px`,i.dataset.translateX=l.toString()}e.type==="touchmove"&&b.forEach(n=>{te(e,n.el)?(s===null||n.el!==s.el)&&T(n.el,n.dropConfig):s!==null&&n.el===s.el&&V(n.el,n.dropConfig)})}function te(e,t){const a=e instanceof MouseEvent&&e.pageX||e instanceof TouchEvent&&e.touches[0].pageX,n=e instanceof MouseEvent&&e.pageY||e instanceof TouchEvent&&e.touches[0].pageY,l=t.getBoundingClientRect();return a>=l.x&&a<=l.x+l.width&&n>=l.y&&n<=l.y+l.height}function D(){var a;if(h!==null){window.clearTimeout(h),h=null;return}const e=oe(),t=j();e&&o&&f(o.dragConfig.onDrop)&&o.dragConfig.onDrop(o.dragConfig.data,t?(a=s==null?void 0:s.dropConfig)==null?void 0:a.data:null),t&&s&&f(s.dropConfig.onDrop)&&s.dropConfig.onDrop(o==null?void 0:o.dragConfig.data,s.dropConfig.data),document.removeEventListener("mousemove",_),document.removeEventListener("touchmove",_),document.removeEventListener("mouseup",D),document.removeEventListener("touchend",D),i!==null&&(i.remove(),i=null),o!==null&&(o.el.classList.remove(o.dragConfig.draggingStateCls),o.el.classList.remove(o.dragConfig.validDragCls),o.el.classList.remove(o.dragConfig.invalidDragCls),o=null),s!==null&&(s.el.classList.remove(s.dropConfig.validDropCls),s.el.classList.remove(s.dropConfig.invalidDropCls),s=null),y=0,w=0}function T(e,t){if(o===null)return;s={el:e,dropConfig:t};const a=j();a?(e.classList.add(t.validDropCls),e.classList.remove(t.invalidDropCls),i&&(i.classList.add(o.dragConfig.validDragCls),i.classList.remove(o.dragConfig.invalidDragCls))):(e.classList.add(t.invalidDropCls),e.classList.remove(t.validDropCls),i&&(i.classList.add(o.dragConfig.invalidDragCls),i.classList.remove(o.dragConfig.validDragCls))),f(o.dragConfig.onDragEnter)&&o.dragConfig.onDragEnter(o.dragConfig.data,s.dropConfig.data,a)}function V(e,t){o!==null&&s!==null&&(f(o.dragConfig.onDragLeave)&&o.dragConfig.onDragLeave(o.dragConfig.data,s.dropConfig.data),e.classList.remove(t.validDropCls),e.classList.remove(t.invalidDropCls),i&&(i.classList.remove(o.dragConfig.validDragCls),i.classList.remove(o.dragConfig.invalidDragCls)),s=null)}function j(){let e=!0,t=!0,a=!0;return(o===null||s===null||s.dropConfig.dragGroup!==o.dragConfig.dragGroup)&&(e=!1),o!==null&&f(o.dragConfig.validateDrop)&&(t=o.dragConfig.validateDrop(o.dragConfig.data,s==null?void 0:s.dropConfig.data)),s!==null&&f(s.dropConfig.validateDrop)&&(a=s.dropConfig.validateDrop(o==null?void 0:o.dragConfig.data,s.dropConfig.data)),e&&t&&a}function oe(){let e=!0,t=!0;return o===null&&(e=!1),o!==null&&f(o.dragConfig.validateDrag)&&(t=o.dragConfig.validateDrag(o.dragConfig.data,s==null?void 0:s.dropConfig.data)),e&&t}function C(e,t){const a={...e};return N(t.value)?Object.assign(a,t.value):Object.assign(a,{data:t.value}),a}const se={mounted(e,t){const a=C(F,t);e.dragConfig=a,e.boundDragListener=ee.bind(this,e,e.dragConfig),a.disabled||(e.classList.add(a.draggableCls),e.addEventListener("mousedown",e.boundDragListener),e.addEventListener("touchstart",e.boundDragListener))},updated(e,t){const a=C(F,t);e.dragConfig&&e.dragConfig.disabled!==a.disabled&&(a.disabled?(e.classList.remove(e.dragConfig.draggableCls),e.boundDragListener&&(e.removeEventListener("mousedown",e.boundDragListener),e.removeEventListener("touchstart",e.boundDragListener))):(e.classList.remove(e.dragConfig.draggableCls),e.classList.add(a.draggableCls),e.boundDragListener&&(e.addEventListener("mousedown",e.boundDragListener),e.addEventListener("touchstart",e.boundDragListener)))),Object.assign(e.dragConfig,a)},unmounted(e,t){const a=C(F,t);e.classList.remove(a.draggableCls),e.boundDragListener&&(e.removeEventListener("mousedown",e.boundDragListener),e.removeEventListener("touchstart",e.boundDragListener))}},ie={mounted(e,t){const a=C(Y,t);b.push({el:e,dropConfig:a}),e.classList.add(a.droppableCls),e.addEventListener("mouseenter",T.bind(this,e,a)),e.addEventListener("mouseleave",V.bind(this,e,a))},unmounted(e,t){const a=C(Y,t);b.splice(b.findIndex(n=>n.el===e),1),e.classList.remove(a.droppableCls),e.removeEventListener("mouseenter",T.bind(this,e,a)),e.removeEventListener("mouseleave",V.bind(this,e,a))},updated:(e,t)=>{const a=b.find(n=>n.el===e);N(t.value)?Object.assign(a==null?void 0:a.dropConfig,t.value):Object.assign(a==null?void 0:a.dropConfig,{data:t.value})}},P=Z({name:"SwPopoverItemResult",directives:{draggable:se,droppable:ie},components:{"sw-search":Q,"sw-popover-item":U,"sw-smooth-reflow":W},props:{options:{type:Array,required:!0},groups:{type:Array,required:!1,default:()=>[]},hideSearch:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},hidable:{type:Boolean,default:!1}},emits:["change-checkbox","change-visibility","click-group-action","click-option","change-order","search"],setup(e,{emit:t}){const a={},n={disabled:!e.draggable,delay:200,onDragStart:()=>{document.body.classList.add("is-popover-item-result-dragging")},onDrop:(u,c)=>{document.body.classList.remove("is-popover-item-result-dragging"),t("change-order",{itemId:u==null?void 0:u.id,dropZone:c==null?void 0:c.dropZone,dropId:c==null?void 0:c.id})}},l=u=>e.draggable&&u.isSortable;return{getOptionsForGroup:u=>e.options.filter(c=>c.parentGroup===u),getDragConfigForOption:u=>({...n,disabled:!l(u)}),isOptionDraggable:l,getIconForOption:u=>{if(l(u))return"solid-grip-vertical-s";if(e.draggable)return"solid-thumbtack"},dropConfig:a,dragConfig:n}}});const ne={class:"sw-popover-item-result"},re=["aria-label"],le={class:"sw-popover-item-result__group-label"},de=["onClick"],ue=["aria-label"],ce={key:0,class:"sw-popover-item-result__option_drop_before"},ge={key:1,class:"sw-popover-item-result__option_drop_after"};function pe(e,t,a,n,l,m){const B=k("sw-search"),I=k("sw-popover-item"),u=k("sw-smooth-reflow"),c=G("droppable"),q=G("draggable");return g(),p("div",ne,[e.hideSearch?v("",!0):(g(),A(B,{key:0,size:"small",onInput:t[0]||(t[0]=d=>e.$emit("search",d))})),(g(!0),p(S,null,M([void 0,...e.groups],d=>(g(),p(S,{key:"transition-group-"+(d&&d.id)},[L(J,{name:"option-fade"},{default:O(()=>[d&&e.getOptionsForGroup(d.id).length>0?(g(),p("div",{key:d.id,class:"sw-popover-item-result__group-header","aria-label":d.label},[H("span",le,X(d.label),1),d.actionLabel?(g(),p("button",{key:0,class:"sw-popover-item-result__group-action",onClick:()=>e.$emit("click-group-action",d.id)},X(d.actionLabel),9,de)):v("",!0)],8,re)):v("",!0)]),_:2},1024),L(u,null,{default:O(()=>[L(K,{name:"option-item",tag:"div"},{default:O(()=>[(g(!0),p(S,null,M(e.getOptionsForGroup(d&&d.id),r=>(g(),p("div",{key:r.id,class:"sw-popover-item-result__option","aria-label":(d&&d.label?d.label:"No group")+": "+r.label},[e.isOptionDraggable(r)?$((g(),p("div",ce,null,512)),[[c,{...e.dropConfig,data:{...r,dropZone:"before"}}]]):v("",!0),$(L(I,{class:"sw-popover-item-result__option_item","is-option-item":e.isOptionDraggable(r),label:r.label,"show-checkbox":e.selectable,"checkbox-checked":r.isSelected,"contextual-detail":r.contextualDetail,"meta-copy":r.metaCopy,"show-visibility":e.hidable&&r.isHidable,visible:r.isVisible,icon:e.getIconForOption(r),"on-label-click":r.isClickable?()=>e.$emit("click-option",r.id):void 0,disabled:r.disabled,onChangeCheckbox:E=>e.$emit("change-checkbox",r.id,E),onChangeVisibility:E=>e.$emit("change-visibility",r.id,E)},null,8,["is-option-item","label","show-checkbox","checkbox-checked","contextual-detail","meta-copy","show-visibility","visible","icon","on-label-click","disabled","onChangeCheckbox","onChangeVisibility"]),[[q,{...e.getDragConfigForOption(r),data:r}]]),e.isOptionDraggable(r)?$((g(),p("div",ge,null,512)),[[c,{...e.dropConfig,data:{...r,dropZone:"after"}}]]):v("",!0)],8,ue))),128))]),_:2},1024)]),_:2},1024)],64))),128))])}const De=z(P,[["render",pe]]);P.__docgenInfo={displayName:"SwPopoverItemResult",exportName:"default",description:"",tags:{},props:[{name:"options",type:{name:"Option[]"},required:!0},{name:"groups",type:{name:"Group[]"},required:!1,defaultValue:{func:!0,value:"() => []"}},{name:"hideSearch",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"draggable",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"selectable",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"hidable",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"search"},{name:"click-group-action"},{name:"change-checkbox"},{name:"change-visibility"},{name:"click-option"},{name:"change-order"}],sourceFiles:["/home/runner/work/meteor-component-library/meteor-component-library/src/components/overlay/sw-popover-item-result/sw-popover-item-result.vue"]};export{De as S,ie as a,se as d};
